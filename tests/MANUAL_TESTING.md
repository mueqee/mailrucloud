# Руководство по ручному тестированию Mail.ru Cloud CLI

Ниже приведён полный чек-лист, который поможет убедиться, что
клиент корректно работает с WebDAV-облаком Mail.ru.

---

## 1. Предварительные условия

1. Создайте «пароль для внешнего приложения» в настройках аккаунта Mail.ru.
2. Клонируйте репозиторий и перейдите в каталог проекта:
   ```bash
   git clone <repo-url>
   cd mailrucloud
   ```
3. Создайте и активируйте виртуальное окружение (Python ≥ 3.10):
   ```bash
   python -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   ```
4. Сохраните учётные данные в файл токена:
   ```bash
   python main.py login
   # введите e-mail и пароль приложения
   ```
   Проверьте, что `~/.mailru_token.json` появился и содержит введённые данные.

---

## 2. Базовые операции

### 2.1 Загрузка файла
```bash
python main.py upload tests/test_small.txt --remote-path /test_small.txt
```
• Ожидаемый вывод — `upload successful` (или аналогичное сообщение).

### 2.2 Список файлов
```bash
python main.py list /
```
• В ответе должен присутствовать `test_small.txt`.

### 2.3 Скачивание файла
```bash
python main.py download /test_small.txt --local-path /tmp/test_small.txt
```
• Убедитесь, что файл появился в `/tmp` и совпадает по размеру/хэшу с оригинальным.

### 2.4 Повторная загрузка (overwrite)
```bash
python main.py upload tests/test_small.txt --remote-path /test_small.txt
```
• Не должно возникнуть ошибок «409 Conflict» — файл перезаписывается.

---

## 3. Тестирование пустого файла

1. Загрузите `tests/test_empty.txt`.
2. Повторите шаги списка и скачивания.
3. Особое внимание: клиент не должен падать из-за отсутствия заголовка `Content-Length`.

---

## 4. Тестирование бинарного файла

1. Загрузите `tests/test_image.jpg`.
2. Скачайте файл в другую папку и сравните MD5-суммы:
   ```bash
   md5sum tests/test_image.jpg /tmp/test_image.jpg
   ```
   Хэши должны совпасть.

---

## 5. Тестирование команды sync

```bash
mkdir /tmp/cloud_sync
cp tests/test_small.txt /tmp/cloud_sync/
python main.py sync /tmp/cloud_sync /
```
• Файл должен появиться в корне облака.


---

## 6. Негативные сценарии

| Сценарий | Ожидаемый результат |
|----------|--------------------|
| Попытка загрузить несуществующий локальный файл | Понятное сообщение об ошибке, процесс завершается с кодом ≠ 0 |
| Скачивание несуществующего удалённого файла | Сообщение «404 Not Found» без трасс-бэка |
| Отсутствуют учётные данные | Предложение выполнить `login` |

---

## 7. Завершение

При успешном прохождении всех пунктов считается, что клиент работает корректно. 